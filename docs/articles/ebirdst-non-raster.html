<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Non-raster Data: Using Predictor Importance, Partial Dependence, and Predictive Performance Metrics • ebirdst</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Non-raster Data: Using Predictor Importance, Partial Dependence, and Predictive Performance Metrics">
<meta property="og:description" content="ebirdst">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ebirdst</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.3.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/ebirdst.html">Get Started</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ebirdst-intro-mapping.html">Introduction to Mapping</a>
    </li>
    <li>
      <a href="../articles/ebirdst-advanced-mapping.html">Advanced Mapping</a>
    </li>
    <li>
      <a href="../articles/ebirdst-non-raster.html">Non-raster Data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Function Reference</a>
</li>
<li>
  <a href="../articles/product-changelog.html#2019-changelog">Changelog</a>
</li>
<li>
  <a href="../news/index.html">Version History</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/CornellLabofOrnithology/ebirdst/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Non-raster Data: Using Predictor Importance, Partial Dependence, and Predictive Performance Metrics</h1>
                        <h4 data-toc-skip class="author">Tom Auer, Daniel Fink</h4>
            
            <h4 data-toc-skip class="date">2022-03-15</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/CornellLabofOrnithology/ebirdst/blob/HEAD/vignettes/ebirdst-non-raster.Rmd" class="external-link"><code>vignettes/ebirdst-non-raster.Rmd</code></a></small>
      <div class="hidden name"><code>ebirdst-non-raster.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="outline">Outline<a class="anchor" aria-label="anchor" href="#outline"></a>
</h2>
<ol style="list-style-type: decimal">
<li><a href="#introduction">Introduction</a></li>
<li><a href="#loading-centroids">Loading Centroids</a></li>
<li><a href="#selecting-region-and-season">Selecting Region and Season</a></li>
<li><a href="#plotting-centroids-and-extent-of-analysis">Plotting Centroids and Extent of Analysis</a></li>
<li><a href="#plot-predictor-importance">Plot Predictor Importance</a></li>
<li><a href="#plot-partial-dependencies">Plot Partial Dependencies</a></li>
<li><a href="#plot-partial-dependencies">Predictive Performance Metrics</a></li>
</ol>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Beyond estimates of occurrence and relative abundance, the eBird Status and Trends products contain estimates of predictor importance (PI), partial dependence (PD), and predictive performance metrics (PPMs). The PPMs can be used to evaluate statistical performance of the models, either over the entire spatiotemporal extent of the model results, or for a specific region and season. Predictor importances (PIs) and partial dependences (PDs can be used to understand relationships between the occurrence or count response and predictors, most notably the land cover variables used in the model. The functions described in this section help load and analyse these data. More details about predictive performance metrics and how they were calculated and interpreted can be found in Fink et al. (2019).</p>
<div class="section level3">
<h3 id="data-structure">Data Structure<a class="anchor" aria-label="anchor" href="#data-structure"></a>
</h3>
<p><strong>IMPORTANT. AFTER DOWNLOADING THE RESULTS, DO NOT CHANGE THE FILE STRUCTURE.</strong> All functionality in this package relies on the structure inherent in the delivered results. Changing the folder and file structure will cause errors with this package.</p>
<p>The non-raster data are stored in two SQLite databases:</p>
<ul>
<li>
<code>pi-pd.db</code>: predictor importance and partial dependence estimates for each stixel used to fit the model.</li>
<li>
<code>predictions.db</code>: predictions on a test dataset consisting of checklists not used in model fitting.</li>
</ul>
<p>The <code>ebirdst</code> package provides functions for accessing these, such that you should never have to handle them manually.</p>
</div>
</div>
<div class="section level2">
<h2 id="pi-and-pd">PI and PD<a class="anchor" aria-label="anchor" href="#pi-and-pd"></a>
</h2>
<p>We’ll start by loading the PI and PD data from the example data package for Yellow-bellied Sapsucker in Michigan.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/CornellLabofOrnithology/ebirdst" class="external-link">ebirdst</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>

<span class="co"># Because the non-raster data is large, there is a parameter on the</span>
<span class="co"># ebirdst_download function that defaults to downloading only the raster data.</span>
<span class="co"># To access the non-raster data, set tifs_only = FALSE.</span>
<span class="va">sp_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebirdst_download.html">ebirdst_download</a></span><span class="op">(</span>species <span class="op">=</span> <span class="st">"example_data"</span>, tifs_only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># predictor importance</span>
<span class="va">pis</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_pis.html">load_pis</a></span><span class="op">(</span><span class="va">sp_path</span><span class="op">)</span>
<span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">pis</span><span class="op">)</span>
<span class="co">#&gt; Rows: 3,310</span>
<span class="co">#&gt; Columns: 78</span>
<span class="co">#&gt; $ stixel_id                        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1-169.6-NSEWWEWW", "1-108.6-NSSEEWNW…</span>
<span class="co">#&gt; $ lat                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 46.30995, 42.42114, 43.67917, 44.1863…</span>
<span class="co">#&gt; $ lon                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -86.72710, -83.54380, -84.03641, -85.…</span>
<span class="co">#&gt; $ date                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.50088033, 0.34482368, 0.67344010, 0…</span>
<span class="co">#&gt; $ is_stationary                    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.73686039, 18.42845245, 0.49824372, …</span>
<span class="co">#&gt; $ year                             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 8.3360735, 9.0877797, 3.3309672, 4.63…</span>
<span class="co">#&gt; $ day                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 11.3270841, 76.2582305, 2.6345454, 4.…</span>
<span class="co">#&gt; $ solar_noon_diff                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 22.0603355, 17.0679989, 4.9493807, 10…</span>
<span class="co">#&gt; $ effort_hrs                       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 42.2916291, 86.3899497, 9.5691303, 17…</span>
<span class="co">#&gt; $ effort_distance_km               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 12.6832239, 44.2907286, 3.3851198, 5.…</span>
<span class="co">#&gt; $ number_observers                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 3.288202581, 3.728937836, 1.285287497…</span>
<span class="co">#&gt; $ score                            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 21.6441015, 25.5800197, 9.4593466, 13…</span>
<span class="co">#&gt; $ eastness_median                  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 11.4480056, 11.0825726, 2.5708314, 5.…</span>
<span class="co">#&gt; $ eastness_sd                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 14.6592890, 16.6060519, 2.3999537, 6.…</span>
<span class="co">#&gt; $ northness_median                 <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 11.1658192, 13.8988250, 2.8692931, 5.…</span>
<span class="co">#&gt; $ northness_sd                     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 15.5729942, 14.2263108, 2.8347340, 7.…</span>
<span class="co">#&gt; $ elev_median                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 22.7490493, 18.4225420, 3.0621725, 6.…</span>
<span class="co">#&gt; $ elev_sd                          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 11.4262689, 12.3861965, 2.6662381, 5.…</span>
<span class="co">#&gt; $ island                           <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ intertidal_fs_c1_1500_ed         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ intertidal_fs_c1_1500_pland      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c1_1500_ed      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.14078947, 1.43435629, 0.18632471, 1…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c1_1500_pland   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.168257217, 0.951096496, 0.128944590…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c2_1500_ed      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c2_1500_pland   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c11_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.750101445, 0.012648084, 0.195781258…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c11_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.909884370, 0.008533362, 0.066898839…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c12_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c12_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c13_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.051595143, 0.165698291, 0.000000000…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c13_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.007885158, 0.014097561, 0.000000000…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c14_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 13.04840239, 5.84305663, 9.70223958, …</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c14_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 22.1780772, 5.5248259, 7.9647364, 8.3…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c15_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 9.15742044, 0.88690266, 1.41852274, 3…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c15_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 9.96608942, 0.93801828, 2.00108458, 2…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c16_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c16_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c21_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10.4627065, 7.7615955, 2.4854609, 5.7…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c21_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 16.0953089, 7.0834174, 6.4837451, 6.2…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c22_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 1.0535637, 10.6589947, 3.8522168, 6.1…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c22_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.8011022, 12.5594966, 7.6254137, 5.6…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c255_1500_ed    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c255_1500_pland <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c31_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 8.6148170, 9.9160136, 2.9347927, 7.65…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c31_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 7.4438603, 9.3446019, 5.3296896, 9.01…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c32_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.95026967, 4.29990544, 0.45147147, 1…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c32_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.55316646, 5.16197385, 0.10550376, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c41_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c41_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c42_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c42_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c43_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs1_fs_c43_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs2_fs_c25_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0000000, 5.9232043, 1.3713915, 1.10…</span>
<span class="co">#&gt; $ mcd12q1_lccs2_fs_c25_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.03490805, 5.21551495, 1.28075439, 1…</span>
<span class="co">#&gt; $ mcd12q1_lccs2_fs_c35_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs2_fs_c35_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs2_fs_c36_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.06635041, 6.28609731, 2.25559086, 1…</span>
<span class="co">#&gt; $ mcd12q1_lccs2_fs_c36_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.15756788, 6.67986530, 3.36702904, 3…</span>
<span class="co">#&gt; $ mcd12q1_lccs3_fs_c27_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.74756721, 1.09676893, 0.54222618, 4…</span>
<span class="co">#&gt; $ mcd12q1_lccs3_fs_c27_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.35277799, 0.98942111, 0.47988197, 3…</span>
<span class="co">#&gt; $ mcd12q1_lccs3_fs_c50_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.81419332, 7.69548046, 0.78421380, 1…</span>
<span class="co">#&gt; $ mcd12q1_lccs3_fs_c50_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.55795070, 10.06800195, 1.04519411, …</span>
<span class="co">#&gt; $ mcd12q1_lccs3_fs_c51_1500_ed     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000000, 0.04313154, 0.00000000, 0…</span>
<span class="co">#&gt; $ mcd12q1_lccs3_fs_c51_1500_pland  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000000, 0.02723233, 0.00000000, 0…</span>
<span class="co">#&gt; $ gp_rtp_1                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.00000000, 7.06547808, 0.88657383, 0…</span>
<span class="co">#&gt; $ gp_rtp_2                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10.61321851, 6.78200580, 1.60907483, …</span>
<span class="co">#&gt; $ gp_rtp_3                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 10.3390283, 18.3259132, 3.7044495, 4.…</span>
<span class="co">#&gt; $ gp_rtp_4                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.3434024668, 0.6480894088, 0.0005555…</span>
<span class="co">#&gt; $ gp_rtp_5                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 2.0032347, 13.2307839, 1.5573661, 3.9…</span>
<span class="co">#&gt; $ astwbd_fs_c1_1500_ed             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ astwbd_fs_c1_1500_pland          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…</span>
<span class="co">#&gt; $ astwbd_fs_c2_1500_ed             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.671402435, 1.672627295, 0.507873200…</span>
<span class="co">#&gt; $ astwbd_fs_c2_1500_pland          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.90665643, 1.80264416, 0.31356354, 0…</span>
<span class="co">#&gt; $ astwbd_fs_c3_1500_ed             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 7.5568283, 10.9095298, 1.6484049, 3.9…</span>
<span class="co">#&gt; $ astwbd_fs_c3_1500_pland          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 9.9276421, 13.4055614, 1.6126631, 5.5…</span>
<span class="co">#&gt; $ ntl_mean                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 16.9331370, 20.2363202, 3.4757637, 9.…</span>
<span class="co">#&gt; $ ntl_sd                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 12.0323973, 19.3811427, 6.5526256, 7.…</span>

<span class="co"># partial dependence</span>
<span class="va">pds</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/load_pds.html">load_pds</a></span><span class="op">(</span><span class="va">sp_path</span><span class="op">)</span>
<span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">pds</span><span class="op">)</span>
<span class="co">#&gt; Rows: 1,818,380</span>
<span class="co">#&gt; Columns: 7</span>
<span class="co">#&gt; $ stixel_id       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "1-169.6-NSEWWEWW", "1-169.6-NSEWWEWW", "1-169.6-NSEWW…</span>
<span class="co">#&gt; $ lat             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 46.30995, 46.30995, 46.30995, 46.30995, 46.30995, 46.3…</span>
<span class="co">#&gt; $ lon             <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -86.7271, -86.7271, -86.7271, -86.7271, -86.7271, -86.…</span>
<span class="co">#&gt; $ date            <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.5008803, 0.5008803, 0.5008803, 0.5008803, 0.5008803,…</span>
<span class="co">#&gt; $ predictor       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> "effort_hrs", "effort_hrs", "effort_hrs", "effort_hrs"…</span>
<span class="co">#&gt; $ predictor_value <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.017000, 0.050000, 0.083000, 0.150000, 0.167000, 0.18…</span>
<span class="co">#&gt; $ response        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.1285892, 0.1325770, 0.1324185, 0.1603675, 0.1716442,…</span></code></pre></div>
<p>Notice that the data in both these data frames is provided for each stixel, identified by a <code>stixel_id</code>.</p>
<div class="section level3">
<h3 id="selecting-region-and-season">Selecting Region and Season<a class="anchor" aria-label="anchor" href="#selecting-region-and-season"></a>
</h3>
<p>When working with Predictive Performance Metrics (PPMs), PIs, or PDs, it is very common to select a subset of space and time for analysis. In <code>ebirdst</code> this is done by creating a spatiotemporal extent object with <code><a href="../reference/ebirdst_extent.html">ebirdst_extent()</a></code>. These objects define the region and season for analysis and are passed to many functions in <code>ebirdst</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># define a spatiotemporal extent</span>
<span class="va">lp_extent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebirdst_extent.html">ebirdst_extent</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="op">-</span><span class="fl">86</span>, xmax <span class="op">=</span> <span class="op">-</span><span class="fl">83</span>, ymin <span class="op">=</span> <span class="fl">42</span>, ymax <span class="op">=</span> <span class="fl">45</span><span class="op">)</span>,
                            t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.425</span>, <span class="fl">0.475</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://www.math.uzh.ch/pages/spam/reference/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">lp_extent</span><span class="op">)</span>
<span class="co">#&gt; eBird Status &amp; Trends extent: </span>
<span class="co">#&gt;   Bounding box: xmin -86; ymin 42; xmax -83; ymax 45</span>
<span class="co">#&gt;   CRS: +proj=longlat +datum=WGS84 +no_defs </span>
<span class="co">#&gt;   Temporal extent: 06-05  -  06-23</span>

<span class="co"># subset to this extent</span>
<span class="va">pis_ss</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebirdst_subset.html">ebirdst_subset</a></span><span class="op">(</span><span class="va">pis</span>, ext <span class="op">=</span> <span class="va">lp_extent</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pis</span><span class="op">)</span>
<span class="co">#&gt; [1] 3310</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/ncell.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">pis_ss</span><span class="op">)</span>
<span class="co">#&gt; [1] 125</span></code></pre></div>
<p>To understand which stixels are contributing to estimates within a given spatiotemporal extent, <code><a href="../reference/stixel_footprint.html">stixel_footprint()</a></code> generate a <code>RasterLayer</code> depicting where a majority of the information is coming from within a given extent. The map ranges from 0 to 1, with pixels have a value of 1 meaning that 100% of the selected stixels are contributing information at that pixel. Calling <code><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot()</a></code> on the output of this function will map the stixel footprint as well as centroids of all the stixels.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span>
<span class="va">footprint</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/stixel_footprint.html">stixel_footprint</a></span><span class="op">(</span><span class="va">sp_path</span>, ext <span class="op">=</span> <span class="va">lp_extent</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">footprint</span><span class="op">)</span></code></pre></div>
<p><img src="ebirdst-non-raster_files/figure-html/plot_extents-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="plot-predictor-importance">Plot Predictor Importance<a class="anchor" aria-label="anchor" href="#plot-predictor-importance"></a>
</h3>
<p>The <code><a href="../reference/plot_pis.html">plot_pis()</a></code> function generates a bar plot showing a rank of the most important predictors within a spatiotemporal subset. There is an option to show all predictors or to aggregate FRAGSTATS by the land cover types.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># with all classes</span>
<span class="fu"><a href="../reference/plot_pis.html">plot_pis</a></span><span class="op">(</span><span class="va">pis</span>, ext <span class="op">=</span> <span class="va">lp_extent</span>, by_cover_class <span class="op">=</span> <span class="cn">FALSE</span>, n_top_pred <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<p><img src="ebirdst-non-raster_files/figure-html/plot_pis-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># aggregating fragstats for cover classes</span>
<span class="fu"><a href="../reference/plot_pis.html">plot_pis</a></span><span class="op">(</span><span class="va">pis</span>, ext <span class="op">=</span> <span class="va">lp_extent</span>, by_cover_class <span class="op">=</span> <span class="cn">TRUE</span>, n_top_pred <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<p><img src="ebirdst-non-raster_files/figure-html/plot_pis-2.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="plotting-partial-dependence">Plotting Partial Dependence<a class="anchor" aria-label="anchor" href="#plotting-partial-dependence"></a>
</h3>
<p>Smoothed partial dependence curves for a given predictor can be plotted using <code><a href="../reference/plot_pds.html">plot_pds()</a></code>. Confidence intervals are estimated through a processing of subsampling and bootstrapping. This function returns the smoothed data and CIs and plots these data. For example, let’s look at PD curves for checklist start time, expressed as the difference from solar noon, and the percentage of broadleaf forest cover. The full list of predictors see the data frame <code>ebirdst_predictors</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># in the interest of speed, run with 5 bootstrap iterations</span>
<span class="co"># in practice, best to run with the default number of iterations (100)</span>
<span class="va">pd_smooth</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_pds.html">plot_pds</a></span><span class="op">(</span><span class="va">pds</span>, <span class="st">"solar_noon_diff"</span>, ext <span class="op">=</span> <span class="va">lp_extent</span>, n_bs <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p><img src="ebirdst-non-raster_files/figure-html/plot_pds-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html" class="external-link">glimpse</a></span><span class="op">(</span><span class="va">pd_smooth</span><span class="op">)</span>
<span class="co">#&gt; Rows: 25</span>
<span class="co">#&gt; Columns: 4</span>
<span class="co">#&gt; $ x         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> -1.197944e+01, -1.098123e+01, -9.983009e+00, -8.984792e+00, …</span>
<span class="co">#&gt; $ pd_median <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0043262826, 0.0043773338, 0.0044533411, 0.0045293485, 0.00…</span>
<span class="co">#&gt; $ pd_lower  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0012936536, 0.0018160488, 0.0027228892, 0.0036297296, 0.00…</span>
<span class="co">#&gt; $ pd_upper  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> 0.0077324375, 0.0073656194, 0.0068719813, 0.0067628259, 0.00…</span>

<span class="co"># deciduous broadleaf forest</span>
<span class="fu"><a href="../reference/plot_pds.html">plot_pds</a></span><span class="op">(</span><span class="va">pds</span>, <span class="st">"mcd12q1_lccs1_fs_c14_1500_pland"</span>, ext <span class="op">=</span> <span class="va">lp_extent</span>, n_bs <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></code></pre></div>
<p><img src="ebirdst-non-raster_files/figure-html/plot_pds-2.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="predictive-performance-metrics">Predictive Performance Metrics<a class="anchor" aria-label="anchor" href="#predictive-performance-metrics"></a>
</h2>
<p>Beyond confidence intervals provided for the abundance estimates, the centroid data can also be used to calculate predictive performance metrics, to get an idea as to whether there is substantial statistical performance to evaluate information provided by PIs and PDs (as well as abundance and occurrence information). Three types of PPMs are calculated:</p>
<ul>
<li>
<strong>Binary or range-based PPMs</strong> assess the ability of model to predict range boundaries</li>
<li>
<strong>Occurrence PPMs</strong> assess the occurrence probability predictions</li>
<li>
<strong>Abundance PPMs</strong> assess the predicted abundance</li>
</ul>
<p>Both the occurrence and count PPMs are within-range metrics, meaning the comparison between observations and predictions is only made within the range where the species occurs.</p>
<p>The function <code><a href="../reference/ebirdst_ppms.html">ebirdst_ppms()</a></code> calculates a suite of PPMs for a given spatiotemporal extent. The results can then be plotted with <code><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ppms</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebirdst_ppms.html">ebirdst_ppms</a></span><span class="op">(</span><span class="va">sp_path</span>, ext <span class="op">=</span> <span class="va">lp_extent</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppms</span><span class="op">)</span></code></pre></div>
<p><img src="ebirdst-non-raster_files/figure-html/ppms-1.png" width="100%" style="display: block; margin: auto;"></p>
<p><code><a href="../reference/ebirdst_ppms_ts.html">ebirdst_ppms_ts()</a></code> can be used to get a time series of PPMs, calculating the full suite either at a weekly or monthly resolution. <code><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot()</a></code> can be used to visualise these PPM time series for a given PPM.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ppms_monthly</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ebirdst_ppms_ts.html">ebirdst_ppms_ts</a></span><span class="op">(</span><span class="va">sp_path</span>, ext <span class="op">=</span> <span class="va">lp_extent</span>, summarize_by <span class="op">=</span> <span class="st">"months"</span><span class="op">)</span>
<span class="co"># plot binary kappa</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppms_monthly</span>, type <span class="op">=</span> <span class="st">"binary"</span>, metric <span class="op">=</span> <span class="st">"kappa"</span><span class="op">)</span></code></pre></div>
<p><img src="ebirdst-non-raster_files/figure-html/binary_by_time-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># plot occurrence probability auc</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ppms_monthly</span>, type <span class="op">=</span> <span class="st">"occurrence"</span>, metric <span class="op">=</span> <span class="st">"auc"</span><span class="op">)</span></code></pre></div>
<p><img src="ebirdst-non-raster_files/figure-html/binary_by_time-2.png" width="100%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h3>
<p>Fink, D., T. Damoulas, &amp; J. Dave, J. 2013. Adaptive Spatio-Temporal Exploratory Models: Hemisphere-wide species distributions from massively crowdsourced eBird data. In Twenty-Seventh AAAI Conference on Artificial Intelligence.</p>
<p>Fink, D., W.M. Hochachka, B. Zuckerberg, D.W. Winkler, B. Shaby, M.A. Munson, G. Hooker, M. Riedewald, D. Sheldon, &amp; S. Kelling. 2010. Spatiotemporal exploratory models for broad‐scale survey data. Ecological Applications, 20(8), 2131-2147.</p>
<p>Fink, D., T. Auer, A. Johnston, V. Ruiz‐Gutierrez, W.M. Hochachka, &amp; S. Kelling. 2019. Modeling avian full annual cycle distribution and population trends with citizen science data. Ecological Applications, 00(00):e02056. <a href="https://doi.org/10.1002/eap.2056" class="external-link uri">https://doi.org/10.1002/eap.2056</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="http://strimas.com" class="external-link">Matthew Strimas-Mackey</a>, Shawn Ligocki, <a href="http://twitter.com/tom_auer" class="external-link">Tom Auer</a>, Daniel Fink.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
